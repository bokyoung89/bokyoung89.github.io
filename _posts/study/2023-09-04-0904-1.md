---
published: true
title: "[AWS] ê³ ì • IPë¥¼ ì´ìš©í•œ í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ë°°í¬"
categories:
- AWS
tag:
- AWS
- SpringBoot
- Docker

toc: true
toc_label: "ëª©ë¡"
toc_icon: "bars"
toc_sticky: true

---
> ğŸ‘©ğŸ»â€ğŸ’» Elastic Compute Cloud / Elastic IP/ Docker Composeë¥¼ ì´ìš©í•˜ì—¬ ec2ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•©ë‹ˆë‹¤.

## Docker Compose ì„¤ì¹˜ ë° ë°°í¬
EC2ì— ì ‘ì†í•˜ì—¬ ë„ì»¤ ë° Gitì„ ì„¤ì¹˜í•´ ë³´ì.

### 1. Git ì„¤ì¹˜
```shell
#Perform a quick update on your instance:
$ sudo yum update -y

#Install git in your EC2 instance
$ sudo yum install git -y

#Check git version
$ git version
```

### 2. ë„ì»¤, ë„ì»¤ ì»´í¬ì¦ˆ ì„¤ì¹˜ ë° ì‹œì‘
docker clientì™€ server(docker daemon)ê°„ í†µì‹  ë°©ì‹ì€ ê¸°ë³¸ì ìœ¼ë¡œ unix domain socket(IPC socket)ì„ ì‚¬ìš©í•˜ë©°, ë‚´ë¶€ì ìœ¼ë¡œ /var/run/docker.sockíŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ í†µì‹ í•œë‹¤.
ë”°ë¼ì„œ, ì•„ë˜ì™€ ê°™ì´ ì„¤ì¹˜ í›„ ê¶Œí•œì„ ë¶€ì—¬í•œë‹¤
```shell
//ë„ì»¤ ì„¤ì¹˜  
$ sudo yum install docker
$ docker -v

// ë„ì»¤ ì»´í¬ì¦ˆ ì„¤ì¹˜ 
$ sudo curl -L https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose   

// ë„ì»¤ ì‹œì‘í•˜ê¸°     
$ sudo systemctl start docker

// ì‹¤í–‰ ê¶Œí•œ ì ìš©   
$ sudo chmod +x /usr/local/bin/docker-compose    
$ sudo chmod 666 /var/run/docker.sock
$ docker-compose -v
```

### 3. Docker Compose íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ” ì†ŒìŠ¤ ë‚´ë ¤ë°›ê¸°
```shell
$ git clone [git web URL]
```

### 4. Docker í™˜ê²½ë³€ìˆ˜
ë¡œì»¬ì—ì„œ ê°œë°œí•  ë•Œ, DB ê³„ì • ì •ë³´ë‚˜ ì™¸ë¶€ì— ë…¸ì¶œë˜ë©´ ì•ˆë˜ëŠ” ê°’ë“¤ì„ ë”°ë¡œ ì œì™¸í•˜ì—¬ ê´€ë¦¬í•˜ì˜€ê³  ì´ë¥¼ ë„ì»¤ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë•Œ ì „ë‹¬í•´ì£¼ì–´ì•¼ í•˜ëŠ”ë° ì´ë•Œ .ENV íŒŒì¼ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
<br />

docker-composeë¥¼ ì‚¬ìš©í• ë•Œ .envë¼ëŠ” íŒŒì¼ì— í™˜ê²½ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ë©´ ìë™ìœ¼ë¡œ ì°¸ì¡°í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
<br />

ì´ë¥¼ ë™ì¼í•˜ê²Œ EC2ì—ì„œë„ docker-composeíŒŒì¼ì´ ìˆëŠ” ìœ„ì¹˜ì— ì•„ë˜ì™€ ê°™ì´ í™˜ê²½ë³€ìˆ˜ ê°’ë“¤ì„ ì¶”ê°€í•´ ì£¼ì–´ì„œ docker-compose ì‹¤í–‰ì‹œ í•´ë‹¹ ê°’ë“¤ì„ ì°¸ì¡°í•˜ì—¬ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

```shell
$ vi .env   

SPRING_DATASOURCE_USERNAME=root
SPRING_DATASOURCE_PASSWORD=1234
```

.env íŒŒì¼ì„ ìƒì„±í›„ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ í†µí•´ ê°’ì„ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.

```shell
$ docker-compose config    
```

### 5. JDK ì„¤ì¹˜ ë° jar íŒŒì¼ ìƒì„±

ì•„ë˜ì™€ ê°™ì´ Amazonì—ì„œ ì œê³µí•˜ëŠ” OpenJDKì¸ Amazon Corettoë¥¼ ë‹¤ìš´ë°›ì•„ ê°„í¸í•˜ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆë‹¤.

```shell
# aws coreetto ë‹¤ìš´ë¡œë“œ
$ sudo curl -L https://corretto.aws/downloads/latest/amazon-corretto-11-x64-linux-jdk.rpm -o jdk11.rpm

# jdk11 ì„¤ì¹˜
$ sudo yum localinstall jdk11.rpm
```

```shell
// í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì œì™¸í•˜ê³ , jar íŒŒì¼ ë¹Œë“œë§Œ ì§„í–‰
$ ./gradlew clean build -x test
```

ë§Œì•½ gradlew ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•  ë•Œ Permission ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²½ìš°, ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•´ì„œ ì‹¤í–‰ê¶Œí•œì„ ë¨¼ì € ì¤€ í›„ ìœ„ ./gradlewë¥¼ ì‹¤í–‰í•œë‹¤.

```shell
$ chmod +x ./gradlew
```

### 6. Docker ì´ë¯¸ì§€ ë°›ê³  Docker Compose ì‹¤í–‰

```shell
$ docker-compose up --build
```

docker-composeë¥¼ ì´ìš©í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.
<br />
ìœ„ì—ì„œ ì ìš©í•œ Elastic IPë¥¼ í†µí•´ ì ‘ì†í•˜ê²Œ ë˜ë©´, ì •ìƒì ìœ¼ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì ‘ì†í•˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.

---

#### reference
[https://wonyong-jang.github.io/aws/2022/06/05/AWS-EC2-Elastic-IP.html](https://wonyong-jang.github.io/aws/2022/06/05/AWS-EC2-Elastic-IP.html)
