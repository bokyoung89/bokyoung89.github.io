---
published: true
title: "[JPA] Spring Date JPAì—ì„œ Querydsl ì‚¬ìš©í•˜ê¸°"
categories:
- JPA
tag:
- JPA
- Querydsl

---
> ğŸ‘©ğŸ»â€ğŸ’» ìŠ¤í”„ë§ 3.x.xì—ì„œ Querydslì„ ì‚¬ìš©í•´ë³´ê³ ì í•©ë‹ˆë‹¤.

## Querydsl ì†Œê°œ

### Querydslì´ë€?
Springbootì™€ JPAë¥¼ ì¡°í•©í•˜ì—¬ ì‚¬ìš©í•  ë•Œ í•´ê²°í•˜ì§€ ëª»í•˜ëŠ” í•œê³„ì ì´ ìˆëŠ”ë° ë°”ë¡œ ë³µì¡í•œ ì¿¼ë¦¬ì™€ ë™ì  ì¿¼ë¦¬ ë¬¸ì œì´ë‹¤.
ì‹¤ë¬´ì—ì„œëŠ” ê²€ìƒ‰ ì¡°ê±´ì— ë”°ë¼ ë³µì¡í•œ ë™ì  ì¿¼ë¦¬ë¥¼ ìƒì„±í•´ì•¼ í•  ì¼ì´ ë§ì€ë°, ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ê¸°ìˆ ì´ Querydslì´ë‹¤.

### Querydslì˜ ì¥ì 
1) Querydslì€ ì¿¼ë¦¬ë¥¼ ìë°” ì½”ë“œë¡œ ì‘ì„±í•  ìˆ˜ ìˆê²Œ ë„ì™€ì¤€ë‹¤. ë”°ë¼ì„œ ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ì»´íŒŒì¼ ì‹œì ì— ì¡ì•„ì¤€ë‹¤.<br/>
2) ë™ì  ì¿¼ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤.<br/>
3) SQL ìŠ¤íƒ€ì¼ì˜ ì‰¬ìš´ ë¬¸ë²•ìœ¼ë¡œ í•™ìŠµë„ ì‰½ê³  ë³µì¡í•œ ì¿¼ë¦¬ë„ ì‰½ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.

## Querydsl ì„¤ì • ë°©ë²•
Querydsl ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ êµ¬ì„±í•´ë³´ì. ìœ ì˜í•  ì ì€ ìŠ¤í”„ë§ ë¶€íŠ¸ ë²„ì „ì— ë”°ë¼ Querydsl ì„¤ì • ë°©ë²•ì´ ì¡°ê¸ˆì”© ë‹¤ë¥´ë‹¤. 
ì´ ê¸€ì— ì‚¬ìš©ëœ í”„ë ˆì„ì›Œí¬/ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
* Spring boot : 3.1.1
* Gradle : 8.1.1
* Querydsl : 5.0.0
* Lombok : 1.18.28

### gradle ì„¤ì •
ë¨¼ì € ë‹¤ìŒê³¼ ê°™ì´ build.gradle íŒŒì¼ì— ì¶”ê°€í•œë‹¤. ëª¨ë“  ì„¤ì •ì´ ë‹¤ í•„ìš”í•œ ê²ƒì€ ì•„ë‹ˆë‹¤.<br/> 
collections ì •ë„ëŠ” ì—†ì–´ë„ ë™ì‘ì—ëŠ” ë¬´ë¦¬ê°€ ì—†ì§€ë§Œ
ì¼ë‹¨ì€ Querydslì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì€ ë‹¤ í¬í•¨ì‹œí‚¤ê³ ì í•œë‹¤.

```java
    //Querydsl ì„¤ì •
    implementation "com.querydsl:querydsl-jpa:5.0.0:jakarta"
    implementation "com.querydsl:querydsl-core"
    implementation "com.querydsl:querydsl-collections"
    annotationProcessor "com.querydsl:querydsl-apt:${dependencyManagement.importedProperties['querydsl.version']}:jakarta" //groovy ë¬¸ë²•ì„ ì´ìš©í•´ ë²„ì „ì„ ìë™ìœ¼ë¡œ ì‚½ì…í•¨
    annotationProcessor "jakarta.annotation:jakarta.annotation-api" //java.lang.NoClassDefFoundError (javax.annotation.Generated) ëŒ€ì‘ ì½”ë“œ
    annotationProcessor "jakarta.persistence:jakarta.persistence-api" //java.lang.NoClassDefFoundError(javax.annotation.Entity) ëŒ€ì‘ ì½”ë“œ
```

Querydsl ì „ìš© ì„¤ì •ë„ ë§ˆì°¬ê°€ì§€ë¡œ build.gradleì— ì¶”ê°€í•œë‹¤. <br/>
IntelliJ IDEì—ì„œ ì‚¬ìš©í•  ë•Œ ìƒê¸¸ ìˆ˜ ìˆëŠ” Grdleê³¼ì˜ ì¤‘ë³µ ë¹Œë“œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì ì¼ë¶€ëŸ¬ QClassì˜ ìƒì„± ìœ„ì¹˜ë¥¼ êº¼ë‚´ë†“ëŠ” ì¶”ê°€ ì„¤ì •ì„ í•˜ì˜€ë‹¤.

```java
// Querydsl ì„¤ì •ë¶€
def generated  = 'src/main/generated' //

//querydal QClass íŒŒì¼ ìƒì„± ìœ„ì¹˜ë¥¼ ì§€ì •
tasks.withType(JavaCompile) {
    options.getGeneratedSourceOutputDirectory().set(file(generated))
}

// java soruce setì— querydsl QClass ìœ„ì¹˜ ì¶”ê°€
sourceSets {
    main.java.srcDirs += [ generated ]
}

// gradle clean ì‹œì— QClass ë””ë ‰í† ë¦¬ ì‚­ì œ
clean {
    delete file(generated)
}
```

ì´ì œ Gradleì˜ buildë¥¼ ì‹¤í–‰í•´ë³´ì. <br/>
ì„¤ì •í•œ íŒŒì¼ ìœ„ì¹˜ (`src/main/generated`) ì— `Qclass`ê°€ ì •ìƒì ìœ¼ë¡œ ìƒì„±ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

![image](https://github.com/bokyoung89/work-board-project/assets/58727604/c5272802-6446-473c-a04a-6e5d7413f408)
![image](https://github.com/bokyoung89/work-board-project/assets/58727604/be30ec54-549f-48c8-8d78-4f322ac63697)

## Querydsl ì‚¬ìš©í•˜ê¸°
ì´ì œ Querydsl ì§€ì›ì„ ì´ìš©í•´ API ê²€ìƒ‰ ì˜µì…˜ì— ì¶”ê°€í•´ë³´ì. <br/>
`QuerydslPredicateExecutor`ì™€ `QuerydslBinderCustomizer`ì„ ì ìš©í•œë‹¤.

### Repository í´ë˜ìŠ¤ ì ìš©
Repository í´ë˜ìŠ¤ì— `QuerydslPredicateExecutor`ì™€ `QuerydslBinderCustomizer`ì„ ìƒì†í•œë‹¤.<br/>
**ì£¼ì˜í•  ì ì€ `QuerydslBinderCustomizer`ì˜ ì œë„¤ë¦­ íƒ€ì…ì€ `Qclass`ë¥¼ ë„£ì–´ì•¼ í•œë‹¤.**
<br />
`QuerydslPredicateExecutor`ì˜ ì—­í• ì€ entity í´ë˜ìŠ¤ì— ì„ ì–¸ëœ ëª¨ë“  í•„ë“œì— ëŒ€í•œ ê¸°ë³¸ ê²€ìƒ‰ ê¸°ëŠ¥ì„ ì¶”ê°€í•´ì¤€ë‹¤.
ë¶€ë¶„ ê²€ìƒ‰ì€ ë¶ˆê°€í•˜ê³  exact matchë¡œë§Œ ë™ì‘í•œë‹¤. `QuerydslBinderCustomizer`ë¥¼ ì¶”ê°€í•˜ë©´ ë¶€ë¶„ ê²€ìƒ‰ ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
<br />
`QuerydslBinderCustomizer`ì˜ customize ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ì—¬ êµ¬í˜„í•˜ë©´, êµ¬í˜„í•œ ë‚´ìš©ì„ í† ëŒ€ë¡œ ê²€ìƒ‰ì˜ ì„¸ë¶€ ê·œì¹™ì´ ì •í•´ì§„ë‹¤.

```java
@RepositoryRestResource
public interface ArticleRepository extends
        JpaRepository<Article, Long>,
        QuerydslPredicateExecutor<Article>,
        QuerydslBinderCustomizer<QArticle> {
    
    @Override
    default void customize(QuerydslBindings bindings, QArticle root) {
        bindings.excludeUnlistedProperties(true); //listingì„ í•˜ì§€ ì•Šì€ propertyëŠ” ê²€ìƒ‰ì—ì„œ ì œì™¸ì‹œí‚´
        bindings.including(root.title, root.content, root.hashtag, root.createdAt, root.createdBy); //ê²€ìƒ‰ ì›í•˜ëŠ” í•„ë“œ ì¶”ê°€
        bindings.bind(root.title).first(StringExpression::containsIgnoreCase); // like '%s{v}%' ëŒ€ì†Œë¬¸ì êµ¬ë¶„ì—†ì´ ê²€ìƒ‰
        bindings.bind(root.content).first(StringExpression::containsIgnoreCase);
        bindings.bind(root.hashtag).first(StringExpression::containsIgnoreCase);
        bindings.bind(root.createdAt).first(DateTimeExpression::eq);
        bindings.bind(root.createdBy).first(StringExpression::containsIgnoreCase);
    }
}
```

### HAL Explorerì—ì„œ ê²€ìƒ‰ ì˜µì…˜ í™•ì¸í•˜ê¸°
ì´ì œê¹Œì§€ ì ìš©í•œ ë‚´ìš©ì„ buildí•˜ê³  ì„œë²„ë¥¼ ì‹¤í–‰í•´ì¤€ë‹¤. <br/>
ë¯¸ë¦¬ ì…‹íŒ…í•´ë‘” HAL Explorerì—ì„œ titleë¡œ ë¶€ë¶„ ê²€ìƒ‰ì„ í•´ë³´ë©´ ê²°ê³¼ê°€ ì˜ ë‚˜ì˜¤ëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
![image](https://github.com/bokyoung89/work-board-project/assets/58727604/1bbc0498-a297-48e7-b948-c5ed1d814961)
![image](https://github.com/bokyoung89/work-board-project/assets/58727604/f1c4197a-41a3-4db8-88a0-7c2946c20641)

## ì •ë¦¬
Spring Data JPAì— Querydslì„ ë”í•˜ë©´ ë‹¨ìˆœ ë°˜ë³µ ê°œë°œ ì½”ë“œë“¤ì´ í™•ì—°íˆ ì¤„ê³  ê°œë°œìëŠ” í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆë‹¤.
ì´ˆê¸° ì„¤ì •ì´ ì¡°ê¸ˆ ê¹Œë‹¤ë¡œìš´ ê²ƒì´ ë‹¨ì ì´ì§€ë§Œ ì‹¤ë¬´ì—ì„œ ì¤‘ìš”í•˜ê²Œ ì“°ì´ëŠ” ê¸°ìˆ ì¸ë§Œí¼ ë°˜ë³µì ìœ¼ë¡œ í™œìš©í•˜ë©° ì²´ë“í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ê² ë‹¤.

---

#### Reference

[https://www.inflearn.com/course/lecture?tab=curriculum&volume=1.00&courseSlug=Querydsl-%EC%8B%A4%EC%A0%84&unitId=30114
](https://www.inflearn.com/course/lecture?tab=curriculum&volume=1.00&courseSlug=Querydsl-%EC%8B%A4%EC%A0%84&unitId=30114)<br/>
[https://madplay.github.io/post/introduction-to-querydsl]([https://madplay.github.io/post/introduction-to-querydsl])
<br/>
10ê°œ í”„ë¡œì íŠ¸ë¡œ ì™„ì„±í•˜ëŠ” ë°±ì—”ë“œ ì›¹ê°œë°œ(Java/Spring) ì´ˆê²©ì°¨ íŒ¨í‚¤ì§€ Online
